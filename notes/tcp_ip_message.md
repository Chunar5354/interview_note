TCP/IP协议五层各自承载数据的方式

## 应用层

应用层的数据称为`报文`

以HTTP协议为例，HTTP报文分为请求报文和响应报文

### 请求报文

请求报文由三部分组成：请求行，首部行和实体

请求行包括方法、所请求对象的URL、HTTP版本，如`GET /somedir/page.html HTTP/1.1`

首部行包括一些可选的首部字段，如HOST, Connection, User-agent, Accept-languag, Referere等

实体就是实际传输的数据

### 响应报文

响应报文由状态行、首部行和实体组成

状态行包括HTTP版本、状态码以及状态信息，如`HTTP1.1 200 OK`

首部行包括Connection, Date, Server, Last_Modified等

实体是实际传输的数据

## 传输层

传输层的数据称为`报文段`

### UDP

UDP报文段也分为首部和数据

首部有`4个字段`：源端口号、目的端口号、长度和检验和，每个字段2字节，共8字节

### TCP

分为首部和数据

首部通常为`20字节`（因为有可选的选项字段），分为以下几个部分：

- 源端口号 16位

- 目的端口号 16位

- 检验和 16位

- 序号 32位

- 确认号 32位

- 接收窗口 16位

- 首部长度 4位

- 标志位 12位 (常用6位: URG, ACK, PSH, RST, SYN, FIN)

- 紧急数据指针 16位

- 选项字段 变长

## 网络层

网络层的数据称为`数据报`

分为首部和数据

### IPV4首部

IPV4首部通常`20字节`，包括以下内容：

- 版本 4位

- 首部长度 4位

- 服务类型 8位

- 数据报长度 16位

- 标志位 16位（3个标志位，13个偏移位），用于IP分片（大于链路层最大传输单元 MTU的数据报要进行分割，到目的地之后再拼接）

- 寿命（Time To Live TTL） 8位，每经过一台路由器，`TTL减1`，当TTL为0时，数据报被`丢弃`

- 上层协议 8位，指示数据应该交给哪个运输层协议

- 首部检验和 16位

- 源、目的IP地址，各32位

- 可变选项

### IPV6

首部长度一般`40字节`，分为以下几部分：

- 版本 4位

- 流量类型（类似IPV4的服务类型） 8位

- 流标签 20位

- 有效载荷长度 16位

- 下一个首部（类似IPV4的上层协议） 8位

- 跳限制（类似TTL） 8位

- 源IP和目的IP 各128位

## 链路层

链路层的数据称为`帧`

主要有6个字段：

- 前同步码 8字节，用于唤醒适配器，开启传输

- 目的地址 6字节，接收适配器的MAC地址

- 源地址 6字节，发送适配器的MAC地址

- 类型 2字节，指示网络层协议

- 数据 承载IP数据包，最小`46字节`，最大`1500字节`，不够需要补足，超过需要分片

- CRC校验码

## 物理层

物理层的数据是`比特位`